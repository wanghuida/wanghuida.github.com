<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Share | 老虎的眼睛]]></title>
  <link href="http://www.wanghd.com/blog/categories/share/atom.xml" rel="self"/>
  <link href="http://www.wanghd.com/"/>
  <updated>2013-07-17T14:12:47+08:00</updated>
  <id>http://www.wanghd.com/</id>
  <author>
    <name><![CDATA[王惠达 huida wanghuida]]></name>
    <email><![CDATA[wanghuida258@yahoo.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[创业公司的运维工作]]></title>
    <link href="http://www.wanghd.com/blog/2013/07/17/chuang-ye-gong-si-de-yun-wei-gong-zuo/"/>
    <updated>2013-07-17T13:04:00+08:00</updated>
    <id>http://www.wanghd.com/blog/2013/07/17/chuang-ye-gong-si-de-yun-wei-gong-zuo</id>
    <content type="html"><![CDATA[<h3>创业公司的运维工作应该尽可能简单，不用追求全自动化，但必要的工作还是要做的。</h3>

<br />


<h3>安全管理</h3>

<ol>
<li>有权限的员工登录服务器需要使用<em>key</em>通过跳板机，再进入线上服务器</li>
<li>外部的请求，需要通过<em>lb</em>转发才能访问，内部服务器无法直接提供服务</li>
<li>内部的服务器访问外网需要通过proxy</li>
<li>内部服务器保存操作记录</li>
<li>加强ddos防护</li>
<li>端口和ip的限制</li>
</ol>


<p>```</p>

<pre><code>       +------+  +---------+        +-----+                                                 
       |  lb  |  |  proxy  |        | ssh |                                                 
       +------+  +---------+        +-----+                                                 
          |           ^                |                                                    
          v           |                |                                                   
      +--------------------------------|---+                                               
      |                                |   |                                                
      |         internal server     &lt;--+   |                                                
      |                                    |                                                
      +------------------------------------+                                               
</code></pre>

<p>```</p>

<!-- more -->


<h3>服务器 (ubuntu)</h3>

<ol>
<li>服务器上架下架，硬件故障（其实创业公司托管还不如用云服务）</li>
<li>常用软件安装，更新，配置</li>
</ol>


<h3>数据库管理 (mysql)</h3>

<ol>
<li>日志管理：2进制日志，错误日志，慢请求日志</li>
<li>优化性能：读写分离，优化慢查询</li>
<li>冷备，热备</li>
<li>安全：限制访问ip, 权限最小化</li>
</ol>


<h3>监控报警 (cacti nagios)</h3>

<ol>
<li>指定报警处理人</li>
<li>添加报警，添加监控</li>
<li>监控和报警本身状态的维护</li>
</ol>


<h3>图片服务 (mogilefs squid php memcache mysql)</h3>

<ol>
<li>图片备份，必须存储2份以上</li>
<li>图片服务优化</li>
<li>图片服务日志分析，统计数据</li>
</ol>


<h3>信息更新</h3>

<ol>
<li>记录每台服务器上处理的job</li>
<li>记录每台服务器上提供的服务</li>
<li>其他重要信息</li>
</ol>


<h3>其他数据备份</h3>

<ol>
<li>svn,git备份</li>
<li>crontab 备份（有过-r直接删除的经验。。。）</li>
<li>一些重要配置的备份</li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CutyCapt html页面生成图片 分享微博]]></title>
    <link href="http://www.wanghd.com/blog/2013/07/15/cutycapt-htmlye-mian-sheng-cheng-tu-pian-fen-xiang-wei-bo/"/>
    <updated>2013-07-15T16:47:00+08:00</updated>
    <id>http://www.wanghd.com/blog/2013/07/15/cutycapt-htmlye-mian-sheng-cheng-tu-pian-fen-xiang-wei-bo</id>
    <content type="html"><![CDATA[<ul>
<li><p>CutyCapt一个用Qt Webkit把html页面生成图片的工具</p></li>
<li><p>Mac下安装使用</p></li>
</ul>


<p>```
brew install cuty_capt</p>

<p>CutyCapt --private-browsing=off --min-width=640 --min-height=440 \</p>

<pre><code>--url="http://meimeidou.cn/diySubject/detail/key/1366957139/magnify/1" --out="/tmp/img.png"
</code></pre>

<p>```</p>

<ul>
<li>Ubuntu生产环境下安装使用</li>
</ul>


<p>```</p>

<h1>xvfb是一个虚拟的X windows</h1>

<p>sudo apt-get install xvfb
sudo apt-get install cutycapt</p>

<h1>搞一个中文字体，雅黑就不错，可以自己找也可以联系我</h1>

<p>scp msyh.ttf idc01-002:/tmp
sudo cp /tmp/msyh.ttf /usr/share/fonts/truetype/</p>

<h1>如果缺少icu48可以装下</h1>

<p>sudo apt-get install libicu48</p>

<h1>生成图片</h1>

<p>xvfb-run --server-args="-screen 0, 1024x768x24" cutycapt --private-browsing=off --min-width=640 --min-height=440 \</p>

<pre><code>--url="http://meimeidou.cn/diySubject/detail/key/1366957139/magnify/1" --out="/tmp/img.png"
</code></pre>

<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[sshfs]]></title>
    <link href="http://www.wanghd.com/blog/2013/05/30/sshfs/"/>
    <updated>2013-05-30T16:57:00+08:00</updated>
    <id>http://www.wanghd.com/blog/2013/05/30/sshfs</id>
    <content type="html"><![CDATA[<ul>
<li>今天看到sshfs可以像mount一样挂上磁盘非常方便记录一下</li>
</ul>


<p>```</p>

<p>sshfs user@hostname:path mount_point</p>

<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[cacti spine的安装配置]]></title>
    <link href="http://www.wanghd.com/blog/2013/05/29/cacti-spinede-an-zhuang-pei-zhi/"/>
    <updated>2013-05-29T15:35:00+08:00</updated>
    <id>http://www.wanghd.com/blog/2013/05/29/cacti-spinede-an-zhuang-pei-zhi</id>
    <content type="html"><![CDATA[<ul>
<li>cacti官方有详细的配置流程，这里只是翻译和错误的解决</li>
</ul>


<p>```bash
wget http://www.cacti.net/downloads/spine/cacti-spine-0.8.8a.tar.gz
tar -zxvf cacti-spine-0.8.8a.tar.gz
cd cacti-spine-0.8.8a/</p>

<p>./configure</p>

<h1>configure: error: Cannot find MySQL headers.  Use --with-mysql= to specify non-default path.</h1>

<h1>下载安装mysqlclient开发包</h1>

<p>sudo apt-get install libmysqlclient-dev</p>

<p>./configure</p>

<h1>configure: error: Cannot find SNMP headers.  Use --with-snmp= to specify non-default path.</h1>

<h1>下载安装snmp开发包</h1>

<p>sudo apt-cache search snmp | grep dev
sudo apt-get install libsnmp-dev</p>

<p>./configure
make
make install
```</p>

<ul>
<li>搞定配置文件</li>
</ul>


<p><code>
cp /usr/local/spine/etc/spine.conf.dist /usr/local/spine/etc/spine.conf
</code></p>

<ul>
<li><p>admin登录cacti页面, 选择Settings的Paths选项卡，输入完整的spine路径[Alternate Poller Path]</p></li>
<li><p>点击Settings的Poller选项卡，从Poller Type里选择spine</p></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[解决 sysDescr: Unknown Object Identifier (Sub-id not found: (top)  sysDescr)]]></title>
    <link href="http://www.wanghd.com/blog/2013/05/29/sysdescr-unknown-object-identifier-sub-id-not-found-top-sysdescr/"/>
    <updated>2013-05-29T11:58:00+08:00</updated>
    <id>http://www.wanghd.com/blog/2013/05/29/sysdescr-unknown-object-identifier-sub-id-not-found-top-sysdescr</id>
    <content type="html"><![CDATA[<ul>
<li>ubuntu安装snmp很方便</li>
</ul>


<p><code>
sudo apt-get install snmp snmpd
</code></p>

<ul>
<li>配置我就跳过了，直接测试，问题来了</li>
</ul>


<p>```
snmpwalk -v 2c -c public 127.0.0.1 sysDescr</p>

<h1>显示 sysDescr: Unknown Object Identifier (Sub-id not found: (top) -> sysDescr)</h1>

<p>```</p>

<ul>
<li><p>网上搜一下，没有正确可行的办法，但是也是有收获</p></li>
<li><p>直接使用snmpwalk -v 2c -c public 127.0.0.1 是没有问题的</p></li>
<li>那就说明问题出在mibs上</li>
<li>尝试解决一下</li>
</ul>


<p>```
sudo apt-get install snmp-mibs-downloader</p>

<p>vim /etc/snmp/snmp.conf</p>

<h1>全部注释下～～～</h1>

<h1>再测试就没问题了，使用了新的mibs</h1>

<p>snmpwalk -v 2c -c public 127.0.0.1 sysDescr</p>

<p>```</p>
]]></content>
  </entry>
  
</feed>
